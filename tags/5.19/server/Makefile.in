SHELL		= /bin/sh
CC		= @CC@
LDFLAGS		= @LDFLAGS@ @LIBS@
EXTRA_OBJS	= @EXTRA_OBJS@
CFLAGS		= @CFLAGS@ -I.
PREFIX		= @prefix@
BINDIR		= $(PREFIX)/bin

#
# Following configurations were tested at least to compile:
# (This section is here for reference only. You should first try to 
# run configure from the toplevel directory.)
#
# GCC: SunOS 4.1.3/4.1.4 or Linux 1.2.13
#CC	=	gcc
#CFLAGS	=	-I../include -O2 -Wall

# Solaris 2.5: SUNWspro C or GCC
#CC	=	cc
#CFLAGS	=	-I../include -xO2 -v
#CC	=	gcc
#CFLAGS	=	-I../include -O2 -Wall
#LDFLAGS =	-L/usr/ucblib -R/usr/ucblib -lrpcsoc -lnsl -lsocket

# Native C compiler on IRIX 5.3, HP-UX 9.01, HP-UX 10.10 or SunOS 4.1.3
#CC	=	cc
#CFLAGS	=	-I../include -O

# For AIX3.2.5 (Not tested with p3nfsd 2.0 or newer)
#AIXLIBS  =	-lbsd
#EXTRA_OBJS =	mount_aix.o



### no need to change anything below this line ###

MOBJS	= 	mp_main.o mp_mount.o nfs_prot_svc.o nfs_prot_xdr.o \
		mp_pfs_ops.o mp_serial.o mp_inode.o mp_xmit.o crc.o pty.o tcp.o
PROGRAM	=	p3nfsd

OBJS	=	$(MOBJS) $(EXTRA_OBJS)


all: $(PROGRAM)
	cp $(PROGRAM) ../bin

$(PROGRAM): $(OBJS)
	$(CC) $(LDFLAGS) -o $@ $(OBJS)

clean celan:
	rm -f $(PROGRAM) $(OBJS) *pure_* .pure *.orig

distclean: clean
	rm -f Makefile config.h *.orig

### Dependencies, generated by :.,$!gcc -MM -I../include *.c
crc.o: crc.c
mount_aix.o: mount_aix.c misc-aix3.h os-aix3.h
mp_inode.o: mp_inode.c nfs_prot.h mp.h cnv.h
mp_main.o: mp_main.c nfs_prot.h mp.h version.h config.h
mp_mount.o: mp_mount.c config.h nfs_prot.h mp.h
mp_pfs_ops.o: mp_pfs_ops.c nfs_prot.h mp.h
mp_serial.o: mp_serial.c nfs_prot.h mp.h config.h
mp_xmit.o: mp_xmit.c nfs_prot.h mp.h config.h
mtab_aix.o: mtab_aix.c
nfs_prot_svc.o: nfs_prot_svc.c nfs_prot.h mp.h
nfs_prot_xdr.o: nfs_prot_xdr.c nfs_prot.h
pty.o: pty.c config.h nfs_prot.h mp.h
